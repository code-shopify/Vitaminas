<div class="{{ section.settings.custom-class }} t4s-container vitatu-section py-5 text-center">
  <h2 class="mb-4">{{ section.settings.heading }}</h2>
  <p class="mb-5">{{ section.settings.subheading }}</p>

  <div class="slider-containerv8">
    <div class="sliderv8">
      {% for block in section.blocks %}
        <div class="slidev8">
          <div class="with-borderv8">
            <video class="tiktok-videov8" controls>
              <source src="{{ block.settings.video_url }}" type="video/mp4">
              Tu navegador no soporta este formato de video.
            </video>
          </div>
          <div class="pause-buttonv8 hiddenv8">⏸</div>
          <div class="play-buttonv8">▶</div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

{% style %}
.slider-containerv8 {
  position: relative;
  width: 100%;
  overflow-x: scroll;
  display: flex;
  align-items: center;
  scroll-snap-type: x mandatory;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 10px;
}

.sliderv8 {
  display: flex;
  gap: 10px;
  scroll-snap-type: x mandatory;
}

.slidev8 {
  flex: 0 0 60%;
  max-width: 360px;
  scroll-snap-align: center;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
}

@media (min-width: 769px) {
  .slidev8 {
    flex: 0 0 50%;
    max-width: 260px;
  }
}

.tiktok-videov8 {
  width: 100%;
  height: auto;
  aspect-ratio: 9 / 16;
  border-radius: 10px;
  display: block;
}

.play-buttonv8,
.pause-buttonv8 {
  position: absolute;
  width: 50px;
  height: 50px;
  background: rgba(0, 0, 0, 0.6);
  color: white;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 20px;
  cursor: pointer;
  z-index: 10;
}

.play-buttonv8 {
  display: flex;
  margin-left: 2px;
}

.pause-buttonv8 {
  display: none;
  opacity: 1;
  transition: opacity 0.5s ease;
}

.pause-buttonv8.hiddenv8 {
  opacity: 0;
}

.with-borderv8 {
  padding: 4px;
  border-radius: 10px;
  background: linear-gradient(0deg, #fe2d52, #28ffff);
}
{% endstyle %}

{% javascript %}
document.addEventListener("DOMContentLoaded", () => {
  const slides = document.querySelectorAll(".slidev8");

  slides.forEach(slide => {
    const playButton = slide.querySelector(".play-buttonv8");
    const pauseButton = slide.querySelector(".pause-buttonv8");
    const video = slide.querySelector("video");

    let hidePauseButtonTimeout;

    const showPauseButton = () => {
      pauseButton.classList.remove("hiddenv8");
      clearTimeout(hidePauseButtonTimeout);
      hidePauseButtonTimeout = setTimeout(() => {
        pauseButton.classList.add("hiddenv8");
      }, 1000);
    };

    playButton.addEventListener("click", () => {
      document.querySelectorAll("video").forEach(v => {
        if (v !== video) {
          v.pause();
          v.classList.remove("playingv8");
        }
      });

      video.play();
      video.classList.add("playingv8");
      playButton.style.display = "none";
      pauseButton.style.display = "flex";
      showPauseButton();
    });

    pauseButton.addEventListener("click", () => {
      video.pause();
      video.classList.remove("playingv8");
      playButton.style.display = "flex";
      pauseButton.style.display = "none";
    });

    video.addEventListener("mousemove", showPauseButton);
    video.addEventListener("click", showPauseButton);

    video.addEventListener("play", () => {
      playButton.style.display = "none";
      pauseButton.style.display = "flex";
      showPauseButton();
    });

    video.addEventListener("pause", () => {
      playButton.style.display = "flex";
      pauseButton.style.display = "none";
    });
  });
});
{% endjavascript %}

{% schema %}
{
  "name": "Sección Videos TikTok",
  "settings": [
    {
      "type": "text",
      "id": "custom-class",
      "label": "Clase Personalizada"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Título Principal",
      "default": "Descubre Nuestros Videos"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subtítulo",
      "default": "Inspírate con el contenido más reciente."
    }
  ],
  "blocks": [
    {
      "type": "video_block",
      "name": "Video",
      "settings": [
        {
          "type": "url",
          "id": "video_url",
          "label": "URL del Video (MP4)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Carrusel de Videos TikTok",
      "category": "Secciones Personalizadas"
    }
  ]
}
{% endschema %}
